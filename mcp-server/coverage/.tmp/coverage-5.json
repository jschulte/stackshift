{"result":[{"scriptId":"427","url":"file:///home/user/stackshift/mcp-server/src/tools/__tests__/analyze.security.test.ts","functions":[{"functionName":"","ranges":[{"startOffset":0,"endOffset":27334,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":13,"endOffset":27334,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":849,"endOffset":9620,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":907,"endOffset":1390,"count":16}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":1427,"endOffset":1555,"count":16},{"startOffset":1538,"endOffset":1551,"count":0}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":1632,"endOffset":2740,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":1728,"endOffset":2252,"count":1},{"startOffset":2036,"endOffset":2246,"count":6}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":2337,"endOffset":2734,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":2636,"endOffset":2646,"count":0}],"isBlockCoverage":false},{"functionName":"","ranges":[{"startOffset":2654,"endOffset":2665,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":2814,"endOffset":4012,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":2892,"endOffset":3323,"count":1},{"startOffset":3127,"endOffset":3317,"count":5}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":3412,"endOffset":3706,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":3784,"endOffset":4006,"count":1},{"startOffset":4000,"endOffset":4005,"count":0}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":4068,"endOffset":5384,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":4143,"endOffset":4525,"count":1},{"startOffset":4340,"endOffset":4519,"count":5}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":4593,"endOffset":4898,"count":1},{"startOffset":4702,"endOffset":4892,"count":2}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":4963,"endOffset":5141,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":5221,"endOffset":5378,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":5443,"endOffset":6766,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":5529,"endOffset":6152,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":6238,"endOffset":6760,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":6841,"endOffset":7475,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":6927,"endOffset":7469,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":7007,"endOffset":7098,"count":5}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":7544,"endOffset":8484,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":7628,"endOffset":7968,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":8056,"endOffset":8478,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":8546,"endOffset":9616,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":8643,"endOffset":9055,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":9139,"endOffset":9610,"count":1},{"startOffset":9325,"endOffset":9445,"count":50}],"isBlockCoverage":true}]},{"scriptId":"429","url":"file:///home/user/stackshift/mcp-server/src/tools/analyze.ts","functions":[{"functionName":"","ranges":[{"startOffset":0,"endOffset":18390,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":13,"endOffset":18390,"count":1}],"isBlockCoverage":true},{"functionName":"analyzeToolHandler","ranges":[{"startOffset":670,"endOffset":3103,"count":34},{"startOffset":855,"endOffset":871,"count":0},{"startOffset":1069,"endOffset":1092,"count":16},{"startOffset":1092,"endOffset":1164,"count":14},{"startOffset":1147,"endOffset":1156,"count":5},{"startOffset":1164,"endOffset":1233,"count":2},{"startOffset":1181,"endOffset":1233,"count":1},{"startOffset":1233,"endOffset":1447,"count":16},{"startOffset":1447,"endOffset":1479,"count":10},{"startOffset":1480,"endOffset":1537,"count":6},{"startOffset":1565,"endOffset":1738,"count":9},{"startOffset":1739,"endOffset":2162,"count":7},{"startOffset":1764,"endOffset":1929,"count":1},{"startOffset":1930,"endOffset":2162,"count":6},{"startOffset":2245,"endOffset":2262,"count":2},{"startOffset":2314,"endOffset":2332,"count":2},{"startOffset":2376,"endOffset":2393,"count":2},{"startOffset":2983,"endOffset":3101,"count":18},{"startOffset":3078,"endOffset":3093,"count":0}],"isBlockCoverage":true},{"functionName":"get","ranges":[{"startOffset":3210,"endOffset":3244,"count":34}],"isBlockCoverage":true},{"functionName":"detectTechStack","ranges":[{"startOffset":3248,"endOffset":4773,"count":16},{"startOffset":3541,"endOffset":4092,"count":15},{"startOffset":3627,"endOffset":3822,"count":14},{"startOffset":3824,"endOffset":3871,"count":0},{"startOffset":3871,"endOffset":3970,"count":14},{"startOffset":3972,"endOffset":4022,"count":0},{"startOffset":4022,"endOffset":4042,"count":14},{"startOffset":4044,"endOffset":4086,"count":0},{"startOffset":4092,"endOffset":4199,"count":15},{"startOffset":4199,"endOffset":4225,"count":0},{"startOffset":4227,"endOffset":4309,"count":0},{"startOffset":4309,"endOffset":4406,"count":15},{"startOffset":4406,"endOffset":4432,"count":0},{"startOffset":4434,"endOffset":4519,"count":0},{"startOffset":4519,"endOffset":4620,"count":15},{"startOffset":4620,"endOffset":4646,"count":0},{"startOffset":4648,"endOffset":4730,"count":0},{"startOffset":4735,"endOffset":4754,"count":1}],"isBlockCoverage":true},{"functionName":"assessCompleteness","ranges":[{"startOffset":4774,"endOffset":5622,"count":16},{"startOffset":5066,"endOffset":5070,"count":1},{"startOffset":5071,"endOffset":5118,"count":15},{"startOffset":5088,"endOffset":5092,"count":0},{"startOffset":5109,"endOffset":5113,"count":0},{"startOffset":5277,"endOffset":5281,"count":0},{"startOffset":5454,"endOffset":5603,"count":0}],"isBlockCoverage":true}]},{"scriptId":"430","url":"file:///home/user/stackshift/mcp-server/src/utils/security.ts","functions":[{"functionName":"","ranges":[{"startOffset":0,"endOffset":17609,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":13,"endOffset":17609,"count":1}],"isBlockCoverage":true},{"functionName":"<instance_members_initializer>","ranges":[{"startOffset":539,"endOffset":3392,"count":34}],"isBlockCoverage":true},{"functionName":"SecurityValidator","ranges":[{"startOffset":700,"endOffset":859,"count":34}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":781,"endOffset":853,"count":68}],"isBlockCoverage":true},{"functionName":"validateDirectory","ranges":[{"startOffset":1133,"endOffset":1861,"count":34},{"startOffset":1211,"endOffset":1314,"count":7},{"startOffset":1314,"endOffset":1666,"count":27},{"startOffset":1666,"endOffset":1836,"count":5},{"startOffset":1836,"endOffset":1860,"count":21}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":1460,"endOffset":1643,"count":52},{"startOffset":1570,"endOffset":1636,"count":51},{"startOffset":1595,"endOffset":1636,"count":20}],"isBlockCoverage":true},{"functionName":"validateFilePath","ranges":[{"startOffset":2171,"endOffset":2779,"count":0}],"isBlockCoverage":false},{"functionName":"sanitizeShellInput","ranges":[{"startOffset":2990,"endOffset":3081,"count":0}],"isBlockCoverage":false},{"functionName":"pathExists","ranges":[{"startOffset":3237,"endOffset":3390,"count":0}],"isBlockCoverage":false},{"functionName":"get","ranges":[{"startOffset":3498,"endOffset":3531,"count":0}],"isBlockCoverage":false},{"functionName":"createDefaultValidator","ranges":[{"startOffset":3535,"endOffset":3859,"count":34},{"startOffset":3660,"endOffset":3692,"count":0},{"startOffset":3693,"endOffset":3738,"count":0}],"isBlockCoverage":true},{"functionName":"get","ranges":[{"startOffset":3970,"endOffset":4008,"count":34}],"isBlockCoverage":true},{"functionName":"validateRoute","ranges":[{"startOffset":4012,"endOffset":4408,"count":21},{"startOffset":4086,"endOffset":4108,"count":6},{"startOffset":4108,"endOffset":4142,"count":15},{"startOffset":4142,"endOffset":4228,"count":0},{"startOffset":4228,"endOffset":4258,"count":15},{"startOffset":4258,"endOffset":4283,"count":6},{"startOffset":4285,"endOffset":4390,"count":5},{"startOffset":4390,"endOffset":4407,"count":10}],"isBlockCoverage":true},{"functionName":"get","ranges":[{"startOffset":4510,"endOffset":4539,"count":21}],"isBlockCoverage":true},{"functionName":"validateClarificationsStrategy","ranges":[{"startOffset":4543,"endOffset":4953,"count":0}],"isBlockCoverage":false},{"functionName":"get","ranges":[{"startOffset":5072,"endOffset":5118,"count":0}],"isBlockCoverage":false},{"functionName":"validateImplementationScope","ranges":[{"startOffset":5122,"endOffset":5511,"count":0}],"isBlockCoverage":false},{"functionName":"get","ranges":[{"startOffset":5627,"endOffset":5670,"count":0}],"isBlockCoverage":false}]},{"scriptId":"432","url":"file:///home/user/stackshift/mcp-server/src/utils/state-manager.ts","functions":[{"functionName":"","ranges":[{"startOffset":0,"endOffset":28552,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":13,"endOffset":28552,"count":1}],"isBlockCoverage":true},{"functionName":"<instance_members_initializer>","ranges":[{"startOffset":446,"endOffset":8236,"count":16}],"isBlockCoverage":true},{"functionName":"StateManager","ranges":[{"startOffset":490,"endOffset":604,"count":16}],"isBlockCoverage":true},{"functionName":"validateState","ranges":[{"startOffset":717,"endOffset":2819,"count":2},{"startOffset":947,"endOffset":1048,"count":0},{"startOffset":1108,"endOffset":1164,"count":0},{"startOffset":1224,"endOffset":1290,"count":0},{"startOffset":1350,"endOffset":1416,"count":0},{"startOffset":1474,"endOffset":1503,"count":1},{"startOffset":1505,"endOffset":1606,"count":0},{"startOffset":1802,"endOffset":1872,"count":0},{"startOffset":1918,"endOffset":1979,"count":0},{"startOffset":2033,"endOffset":2160,"count":0},{"startOffset":2228,"endOffset":2285,"count":0},{"startOffset":2380,"endOffset":2453,"count":0},{"startOffset":2541,"endOffset":2614,"count":0},{"startOffset":2688,"endOffset":2748,"count":0}],"isBlockCoverage":true},{"functionName":"safeJsonParse","ranges":[{"startOffset":2889,"endOffset":3059,"count":1}],"isBlockCoverage":true},{"functionName":"atomicWrite","ranges":[{"startOffset":3230,"endOffset":3673,"count":15},{"startOffset":3539,"endOffset":3669,"count":0}],"isBlockCoverage":true},{"functionName":"load","ranges":[{"startOffset":3796,"endOffset":4462,"count":1},{"startOffset":3945,"endOffset":4011,"count":0},{"startOffset":4141,"endOffset":4260,"count":0},{"startOffset":4288,"endOffset":4458,"count":0}],"isBlockCoverage":true},{"functionName":"createInitialState","ranges":[{"startOffset":4623,"endOffset":5196,"count":14},{"startOffset":4846,"endOffset":4853,"count":5}],"isBlockCoverage":true},{"functionName":"initialize","ranges":[{"startOffset":5389,"endOffset":5690,"count":14},{"startOffset":5493,"endOffset":5532,"count":0}],"isBlockCoverage":true},{"functionName":"update","ranges":[{"startOffset":5925,"endOffset":6340,"count":1},{"startOffset":6170,"endOffset":6277,"count":0}],"isBlockCoverage":true},{"functionName":"updateRoute","ranges":[{"startOffset":6446,"endOffset":6804,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":6496,"endOffset":6798,"count":1},{"startOffset":6638,"endOffset":6691,"count":0},{"startOffset":6775,"endOffset":6783,"count":0}],"isBlockCoverage":true},{"functionName":"completeStep","ranges":[{"startOffset":6968,"endOffset":7557,"count":0}],"isBlockCoverage":false},{"functionName":"getNextStep","ranges":[{"startOffset":7701,"endOffset":7995,"count":0}],"isBlockCoverage":false},{"functionName":"exists","ranges":[{"startOffset":8087,"endOffset":8234,"count":16},{"startOffset":8171,"endOffset":8197,"count":2},{"startOffset":8197,"endOffset":8230,"count":14}],"isBlockCoverage":true},{"functionName":"get","ranges":[{"startOffset":8337,"endOffset":8365,"count":16}],"isBlockCoverage":true}]},{"scriptId":"433","url":"file:///home/user/stackshift/mcp-server/src/utils/file-utils.ts","functions":[{"functionName":"","ranges":[{"startOffset":0,"endOffset":10213,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":13,"endOffset":10213,"count":1}],"isBlockCoverage":true},{"functionName":"findFiles","ranges":[{"startOffset":324,"endOffset":1445,"count":16}],"isBlockCoverage":true},{"functionName":"search","ranges":[{"startOffset":453,"endOffset":1395,"count":38},{"startOffset":515,"endOffset":536,"count":0},{"startOffset":573,"endOffset":594,"count":0},{"startOffset":693,"endOffset":729,"count":30},{"startOffset":729,"endOffset":1349,"count":874},{"startOffset":771,"endOffset":799,"count":0},{"startOffset":903,"endOffset":1099,"count":22},{"startOffset":979,"endOffset":1007,"count":0},{"startOffset":1009,"endOffset":1044,"count":0},{"startOffset":1099,"endOffset":1341,"count":852},{"startOffset":1125,"endOffset":1341,"count":851},{"startOffset":1197,"endOffset":1331,"count":1651},{"startOffset":1245,"endOffset":1319,"count":52},{"startOffset":1349,"endOffset":1356,"count":30},{"startOffset":1356,"endOffset":1391,"count":8}],"isBlockCoverage":true},{"functionName":"get","ranges":[{"startOffset":1543,"endOffset":1568,"count":0}],"isBlockCoverage":false},{"functionName":"countFiles","ranges":[{"startOffset":1572,"endOffset":1699,"count":16}],"isBlockCoverage":true},{"functionName":"get","ranges":[{"startOffset":1798,"endOffset":1824,"count":16}],"isBlockCoverage":true},{"functionName":"fileExists","ranges":[{"startOffset":1828,"endOffset":1976,"count":77},{"startOffset":1923,"endOffset":1945,"count":15},{"startOffset":1945,"endOffset":1974,"count":62}],"isBlockCoverage":true},{"functionName":"get","ranges":[{"startOffset":2075,"endOffset":2101,"count":77}],"isBlockCoverage":true},{"functionName":"readFileSafe","ranges":[{"startOffset":2105,"endOffset":2417,"count":15},{"startOffset":2261,"endOffset":2355,"count":0}],"isBlockCoverage":true},{"functionName":"get","ranges":[{"startOffset":2518,"endOffset":2546,"count":0}],"isBlockCoverage":false},{"functionName":"readJsonSafe","ranges":[{"startOffset":2550,"endOffset":2777,"count":15}],"isBlockCoverage":true},{"functionName":"get","ranges":[{"startOffset":2878,"endOffset":2906,"count":15}],"isBlockCoverage":true}]}]}